---
title: GET /metrics
description: Retrieve analytics data and insights
---

# GET /metrics

Retrieve aggregated analytics data including totals, timeseries, and breakdowns.

## Request

```
GET /metrics
```

### Headers

| Header | Required | Description |
|--------|----------|-------------|
| `x-api-key` | Yes | Your project API key |

### Query Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| `range` | string | `7d` | Time range for data (e.g., "7d", "30d", "1y") |
| `exclude_dev` | string | `true` | Exclude development traffic from results |
| `project` | string | - | Project identifier (optional) |

#### Supported Range Values

- `1d` - Last 24 hours
- `7d` - Last 7 days  
- `30d` - Last 30 days
- `90d` - Last 90 days
- `1y` - Last 365 days

## Response

### Success (200 OK)

```json
{
  "totals": {
    "users": 1250,
    "sessions": 2100,
    "pageviews": 5780,
    "avgDuration": 2340
  },
  "timeseries": [
    {
      "date": "2024-01-01",
      "users": 45,
      "sessions": 67,
      "pageviews": 142
    },
    {
      "date": "2024-01-02", 
      "users": 52,
      "sessions": 78,
      "pageviews": 156
    }
  ],
  "breakdowns": {
    "topPages": [
      {
        "url": "/",
        "views": 890,
        "avgDuration": 3200
      },
      {
        "url": "/features",
        "views": 456,
        "avgDuration": 2800
      }
    ],
    "countries": [
      {
        "country": "Netherlands",
        "users": 456
      },
      {
        "country": "Germany", 
        "users": 234
      }
    ],
    "browsers": [
      {
        "browser": "Chrome 120",
        "users": 678
      },
      {
        "browser": "Safari 17",
        "users": 234
      }
    ],
    "devices": [
      {
        "device": "desktop",
        "users": 789
      },
      {
        "device": "mobile",
        "users": 461
      }
    ]
  }
}
```

### Response Schema

#### Totals Object

| Field | Type | Description |
|-------|------|-------------|
| `users` | number | Total unique users |
| `sessions` | number | Total sessions |
| `pageviews` | number | Total pageviews |
| `avgDuration` | number | Average session duration (ms) |

#### Timeseries Array

Array of daily data points:

| Field | Type | Description |
|-------|------|-------------|
| `date` | string | Date in YYYY-MM-DD format |
| `users` | number | Unique users for this date |
| `sessions` | number | Sessions for this date |
| `pageviews` | number | Pageviews for this date |

#### Breakdowns Object

##### Top Pages

| Field | Type | Description |
|-------|------|-------------|
| `url` | string | Page URL |
| `views` | number | Total pageviews |
| `avgDuration` | number | Average time on page (ms) |

##### Countries

| Field | Type | Description |
|-------|------|-------------|
| `country` | string | Country name |
| `users` | number | Unique users from this country |

##### Browsers

| Field | Type | Description |
|-------|------|-------------|
| `browser` | string | Browser name and version |
| `users` | number | Unique users using this browser |

##### Devices

| Field | Type | Description |
|-------|------|-------------|
| `device` | string | Device type (desktop, mobile, tablet) |
| `users` | number | Unique users on this device type |

### Error Responses

#### 401 Unauthorized

```json
{
  "error": "API key required"
}
```

```json
{
  "error": "Invalid API key"
}
```

#### 500 Internal Server Error

```json
{
  "error": "Internal server error"
}
```

## Examples

### Get Last 7 Days Data

```bash
curl -H "x-api-key: your-api-key" \
     "http://localhost:8000/metrics?range=7d"
```

### Get Last 30 Days Including Dev Traffic

```bash
curl -H "x-api-key: your-api-key" \
     "http://localhost:8000/metrics?range=30d&exclude_dev=false"
```

### Get Last Year Data

```bash
curl -H "x-api-key: your-api-key" \
     "http://localhost:8000/metrics?range=1y"
```

## Usage with JavaScript

```javascript path=null start=null
async function fetchAnalytics() {
  const response = await fetch('http://localhost:8000/metrics?range=30d', {
    headers: {
      'x-api-key': 'your-api-key'
    }
  })
  
  if (!response.ok) {
    throw new Error('Failed to fetch analytics')
  }
  
  const data = await response.json()
  return data
}

async function displayMetrics() {
  try {
    const metrics = await fetchAnalytics()
    console.log(`Total users: ${metrics.totals.users}`)
    console.log(`Total sessions: ${metrics.totals.sessions}`)
    console.log(`Total pageviews: ${metrics.totals.pageviews}`)
  } catch (error) {
    console.error('Error fetching metrics:', error)
  }
}
```

## Development vs Production Traffic

By default, development traffic is excluded from metrics (`exclude_dev=true`). Development traffic is automatically detected based on:

- `x-dev-traffic: true` header
- `localhost` hostnames
- Development environment indicators

To include development traffic in your metrics:

```bash
curl -H "x-api-key: your-api-key" \
     "http://localhost:8000/metrics?exclude_dev=false"
```

## Caching and Performance

- Metrics are computed in real-time from the database
- For high-traffic applications, consider implementing caching
- Future versions may include built-in caching mechanisms

## Limitations

- Currently returns all breakdowns without pagination
- No filtering by specific date ranges (only predefined ranges)
- No custom aggregations or filtering options

These limitations may be addressed in future API versions.
