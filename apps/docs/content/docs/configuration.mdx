---
title: Configuration
description: Environment variables and configuration options
---

# Configuration

HONO Analytics uses environment variables for configuration. This page covers all available settings for both the backend API and SDK.

## Backend Configuration

### Environment Variables

The backend requires several environment variables for proper operation:

```bash path=/packages/backend/.env start=null
# Backend Environment Variables
NODE_ENV=development
PORT=8000

# Database Configuration
# For PostgreSQL (production):
DATABASE_URL=postgresql://analytics_user:analytics_pass@localhost:5432/analytics

# For SQLite (local development):
# DATABASE_URL=sqlite:./packages/backend/analytics.db

# API Keys (for seeding projects table)
DEFAULT_API_KEY=dev-key-12345

# Development
LOG_LEVEL=info
```

### Required Variables

| Variable | Description | Example | Required |
|----------|-------------|---------|----------|
| `DATABASE_URL` | Database connection string | `postgresql://user:pass@host:5432/db` | Yes |
| `DEFAULT_API_KEY` | Default API key for development | `dev-key-12345` | Yes |

### Optional Variables

| Variable | Description | Default | Example |
|----------|-------------|---------|---------|
| `NODE_ENV` | Environment mode | `development` | `production` |
| `PORT` | Server port | `8000` | `3000` |
| `LOG_LEVEL` | Logging level | `info` | `debug`, `warn`, `error` |

### Database Options

#### PostgreSQL (Recommended for Production)

```bash
DATABASE_URL=postgresql://username:password@hostname:5432/database_name
```

Example configurations:
```bash
# Local PostgreSQL
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/analytics

# Production PostgreSQL
DATABASE_URL=postgresql://analytics_user:secure_password@db.example.com:5432/analytics

# With SSL
DATABASE_URL=postgresql://user:pass@hostname:5432/dbname?sslmode=require
```

#### SQLite (Development)

```bash
DATABASE_URL=sqlite:./packages/backend/analytics.db
```

SQLite is suitable for:
- Local development
- Testing
- Small deployments
- No Docker environments

### API Key Configuration

The `DEFAULT_API_KEY` is used to:
- Seed the projects table on startup
- Provide a default key for development
- Enable quick testing without manual project creation

In production, create proper API keys through the database or admin interface.

## SDK Configuration

### React SDK Configuration

```tsx path=null start=null
type TProps = {
  children: React.ReactNode
}

export function App({ children }: TProps) {
  return (
    <AnalyticsProvider
      apiKey={process.env.NEXT_PUBLIC_ANALYTICS_API_KEY!}
      projectId={process.env.NEXT_PUBLIC_ANALYTICS_PROJECT_ID!}
      endpoint={process.env.NEXT_PUBLIC_ANALYTICS_ENDPOINT}
      debug={process.env.NODE_ENV === 'development'}
      ignoreAnalytics={process.env.NODE_ENV === 'test'}
    >
      {children}
    </AnalyticsProvider>
  )
}
```

### Vanilla SDK Configuration

```javascript path=null start=null
import { initAnalytics } from '@hono-analytics/sdk'

const analytics = initAnalytics({
  apiKey: process.env.VITE_ANALYTICS_API_KEY,
  projectId: process.env.VITE_ANALYTICS_PROJECT_ID,
  endpoint: process.env.VITE_ANALYTICS_ENDPOINT,
  debug: process.env.NODE_ENV === 'development'
})
```

### SDK Environment Variables

For frontend applications, set these environment variables:

### Next.js (prefix with NEXT_PUBLIC_)
```bash path=/.env.local start=null
NEXT_PUBLIC_ANALYTICS_API_KEY=your-api-key
NEXT_PUBLIC_ANALYTICS_PROJECT_ID=your-project-id
NEXT_PUBLIC_ANALYTICS_ENDPOINT=https://analytics.example.com
```

### Vite (prefix with VITE_)
```bash path=/.env.local start=null
VITE_ANALYTICS_API_KEY=your-api-key
VITE_ANALYTICS_PROJECT_ID=your-project-id
VITE_ANALYTICS_ENDPOINT=https://analytics.example.com
```

### SDK Options

```typescript path=null start=null
type TAnalyticsOptions = {
  apiKey: string              // Your project API key
  projectId: string           // Your project identifier
  endpoint?: string           // API endpoint URL
  ignoreAnalytics?: boolean   // Disable all tracking
  debug?: boolean             // Enable debug logging
}
```

| Option | Type | Required | Default | Description |
|--------|------|----------|---------|-------------|
| `apiKey` | string | Yes | - | Project API key from backend |
| `projectId` | string | Yes | - | Unique project identifier |
| `endpoint` | string | No | `http://localhost:8000` | Backend API URL |
| `ignoreAnalytics` | boolean | No | `false` | Completely disable tracking |
| `debug` | boolean | No | `false` | Log debug information |

## Environment-Specific Configuration

### Development Environment

```bash path=/.env.development start=null
# Backend
NODE_ENV=development
PORT=8000
DATABASE_URL=sqlite:./packages/backend/analytics.db
DEFAULT_API_KEY=dev-key-12345
LOG_LEVEL=debug

# Frontend
VITE_ANALYTICS_API_KEY=dev-key-12345
VITE_ANALYTICS_PROJECT_ID=default-project
VITE_ANALYTICS_ENDPOINT=http://localhost:8000
```

Development features:
- SQLite for easy setup
- Debug logging enabled
- Localhost CORS allowed
- Development traffic filtering

### Staging Environment

```bash path=/.env.staging start=null
# Backend
NODE_ENV=staging
PORT=8000
DATABASE_URL=postgresql://staging_user:staging_pass@staging-db:5432/analytics
DEFAULT_API_KEY=staging-key-67890
LOG_LEVEL=info

# Frontend
VITE_ANALYTICS_API_KEY=staging-key-67890
VITE_ANALYTICS_PROJECT_ID=staging-project
VITE_ANALYTICS_ENDPOINT=https://staging-analytics.example.com
```

### Production Environment

```bash path=/.env.production start=null
# Backend
NODE_ENV=production
PORT=8000
DATABASE_URL=postgresql://prod_user:secure_password@prod-db:5432/analytics
DEFAULT_API_KEY=prod-key-secure-123
LOG_LEVEL=warn

# Frontend
VITE_ANALYTICS_API_KEY=prod-key-secure-123
VITE_ANALYTICS_PROJECT_ID=production-project
VITE_ANALYTICS_ENDPOINT=https://analytics.example.com
```

Production considerations:
- Use PostgreSQL for reliability
- Secure API keys
- Reduced logging
- HTTPS endpoints
- CORS restricted to production domains

## CLI Commands

### Database Management

```bash
# Navigate to backend
cd packages/backend

# Generate migrations
pnpm db:generate

# Run migrations
pnpm db:migrate

# Reset database (development only)
pnpm db:reset
```

### Development Commands

```bash
# Start all services
./dev.sh

# Start backend only
pnpm --filter backend dev

# Start example app only
pnpm --filter example dev

# Start docs site
pnpm --filter docs dev
```

### Production Commands

```bash
# Build backend
pnpm --filter backend build

# Start production backend
pnpm --filter backend start

# Build frontend
pnpm --filter example build
```

## Docker Configuration

### Environment Variables for Docker

```yaml path=/docker-compose.yml start=null
version: '3.8'
services:
  backend:
    build: .
    environment:
      - NODE_ENV=production
      - PORT=8000
      - DATABASE_URL=postgresql://postgres:postgres@db:5432/analytics
      - DEFAULT_API_KEY=docker-api-key
    ports:
      - "8000:8000"
    depends_on:
      - db
  
  db:
    image: postgres:15
    environment:
      - POSTGRES_DB=analytics
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=postgres
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
```

### Docker Environment File

```bash path=/.env.docker start=null
# Docker-specific environment variables
DATABASE_URL=postgresql://postgres:postgres@db:5432/analytics
DEFAULT_API_KEY=docker-api-key-secure
NODE_ENV=production
PORT=8000
```

## Security Considerations

### API Key Security

- Use strong, unique API keys for each environment
- Rotate API keys regularly
- Store keys securely (use secret management systems)
- Never commit API keys to version control

### Database Security

```bash
# Use connection pooling
DATABASE_URL=postgresql://user:pass@host:5432/db?pool=true

# Use SSL in production
DATABASE_URL=postgresql://user:pass@host:5432/db?sslmode=require

# Limit connections
DATABASE_URL=postgresql://user:pass@host:5432/db?pool=true&poolsize=10
```

### CORS Configuration

Configure CORS origins in `packages/backend/src/server.ts`:

```typescript path=/packages/backend/src/server.ts start=null
app.use('*', cors({
  origin: [
    'http://localhost:3000',
    'http://localhost:3001', 
    'https://yourapp.com',
    'https://staging.yourapp.com'
  ],
  allowMethods: ['GET', 'POST', 'OPTIONS'],
  allowHeaders: ['Content-Type', 'Authorization', 'x-api-key', 'x-dev-traffic'],
  credentials: true
}))
```

## Validation

### Environment Validation

Create a validation function for required environment variables:

```typescript path=null start=null
type TEnvironmentConfig = {
  nodeEnv: string
  port: number
  databaseUrl: string
  defaultApiKey: string
  logLevel: string
}

function validateEnvironment(): TEnvironmentConfig {
  const required = ['DATABASE_URL', 'DEFAULT_API_KEY']
  
  function checkRequired(key: string): string {
    const value = process.env[key]
    if (!value) {
      throw new Error(`Required environment variable ${key} is not set`)
    }
    return value
  }
  
  return {
    nodeEnv: process.env.NODE_ENV || 'development',
    port: parseInt(process.env.PORT || '8000'),
    databaseUrl: checkRequired('DATABASE_URL'),
    defaultApiKey: checkRequired('DEFAULT_API_KEY'),
    logLevel: process.env.LOG_LEVEL || 'info'
  }
}

const config = validateEnvironment()
```

## Troubleshooting Configuration

### Common Issues

**Database Connection Failed**
```bash
# Check DATABASE_URL format
echo $DATABASE_URL

# Test PostgreSQL connection
psql $DATABASE_URL -c "SELECT 1;"

# Check if SQLite file exists and is writable
ls -la packages/backend/analytics.db
```

**API Key Invalid**
```bash
# Verify API key in environment
echo $DEFAULT_API_KEY

# Check projects table
psql $DATABASE_URL -c "SELECT * FROM projects;"
```

**CORS Errors**
- Verify frontend origin is in CORS allowlist
- Check that both frontend and backend are running
- Ensure HTTPS/HTTP protocol matches

For more troubleshooting help, see the [Troubleshooting Guide](/docs/troubleshooting).

## Next Steps

<Cards>
  <Card title="Getting Started" href="/docs/getting-started" description="Initial setup and installation" />
  <Card title="Deployment" href="/docs/deployment" description="Production deployment guide" />
  <Card title="Database Schema" href="/docs/database-schema" description="Database structure and relationships" />
  <Card title="Troubleshooting" href="/docs/troubleshooting" description="Common issues and solutions" />
</Cards>
